{
    "constants": [
        { "type": "uint8_t", "name": "num_effectors", "value": 16, "desc": "number of effector channels" },
        { "type": "uint8_t", "name": "max_calibration", "value": 4, "desc": "maximum nubmer of calibration coefficients" }
    ],

    "enums": [
        {
            "name": "sensor_type",
            "identifiers": [
                { "name": "time" },
                { "name": "input_voltage" },
                { "name": "regulated_voltage" },
                { "name": "pwm_voltage" },
                { "name": "sbus_voltage" },
                { "name": "internal_bme280" },
                { "name": "sbus" }
            ]
        },
        {
            "name": "effector_type",
            "identifiers": [
                { "name": "motor" },
                { "name": "pwm" },
                { "name": "sbus" }
            ]
        }
    ],
    
    "messages": [
        {
            "id": 10,
            "name": "mode_command",
            "fields": [
                { "type": "int8_t", "name": "mode" }
            ]
        },
        {
            "name": "command_effectors",
            "fields": [
                { "type": "uint8_t", "name": "num_active" },
                { "type": "float", "name": "command[num_effectors]", "pack_type": "int16_t", "pack_scale": 32767 }
            ]
        },
        {
            "name": "config_ack",
            "fields": [
                { "type": "uint8_t", "name": "ack_id" },
                { "type": "uint8_t", "name": "ack_subid" }
            ]
        },
        {
            "name": "config_basic",
            "fields": [
                { "type": "sensor_type", "name": "sensor" },
                { "type": "string", "name": "output" }
            ]
        },
        {
            "name": "config_mpu9250",
            "fields": [
                { "type": "bool", "name": "internal" },
                { "type": "uint8_t", "name": "SRD" },
                { "type": "float", "name": "orientation[9]" },
                { "type": "int8_t", "name": "DLPF_bandwidth_hz" },
                { "type": "string", "name": "output" },
                { "type": "bool", "name": "use_spi" },     // external
                { "type": "uint8_t", "name": "spi_bus" },     // external
                { "type": "uint8_t", "name": "cs_pin" },   // external
                { "type": "uint8_t", "name": "mosi_pin" }, // node
                { "type": "uint8_t", "name": "miso_pin" }, // node
                { "type": "uint8_t", "name": "sck_pin" },  // node
                { "type": "uint8_t", "name": "i2c_bus" },     // external
                { "type": "uint8_t", "name": "i2c_addr" } // external
            ]
        },
        {
            "name": "config_bme280",
            "fields": [
                { "type": "bool", "name": "use_spi" },
                { "type": "uint8_t", "name": "spi_bus" },
                { "type": "uint8_t", "name": "cs_pin" },
                { "type": "uint8_t", "name": "mosi_pin" },
                { "type": "uint8_t", "name": "miso_pin" },
                { "type": "uint8_t", "name": "sck_pin" },
                { "type": "uint8_t", "name": "i2c_bus" },
                { "type": "uint8_t", "name": "i2c_addr" },
                { "type": "string", "name": "output" }
            ]
        },
        {
            "name": "config_ublox",
            "fields": [
                { "type": "uint8_t", "name": "uart" },
                { "type": "uint32_t", "name": "baud" },
                { "type": "string", "name": "output" }
            ]
        },
        {
            "name": "config_ams5915",
            "fields": [
                { "type": "uint8_t", "name": "i2c_bus" },
                { "type": "uint8_t", "name": "i2c_addr" },
                { "type": "string", "name": "transducer" },
                { "type": "string", "name": "output" }
            ]
        },
        {
            "name": "config_swift",
            "fields": [
                { "type": "uint8_t", "name": "i2c_bus" },
                { "type": "uint8_t", "name": "static_i2c_addr" },
                { "type": "uint8_t", "name": "diff_i2c_addr" },
                { "type": "string", "name": "diff_transducer" },
                { "type": "string", "name": "output" }
            ]
        },
        {
            "name": "config_analog",
            "fields": [
                { "type": "uint8_t", "name": "channel" },
                { "type": "float", "name": "calibration[max_calibration]" },
                { "type": "string", "name": "output" }
            ]
        },
        {
            "name": "config_effector",
            "fields": [
                { "type": "effector_type", "name": "effector" },
                { "type": "string", "name": "input" },
                { "type": "uint8_t", "name": "channel" }, 
                { "type": "float", "name": "calibration[max_calibration]" },
                { "type": "uint8_t", "name": "safed_command" }
           ]
        },
        {
            "name": "config_mission",
            "fields": [
                { "type": "string", "name": "switch_name" },
                { "type": "string", "name": "source" },
                { "type": "float", "name": "gain", "default": 1.0 },
                { "type": "float", "name": "threshold", "default": 0.5 }
            ]
        }
    ]
}

